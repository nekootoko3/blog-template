---
title: "プログラミング TypeScriptを読んだ"
createdAt: "2019-10-31"
updatedAt: "2019-10-31"
canPublish: true
tag: redis, ruby
---

# プログラミング TypeScript を読んだ

### 2章 TypeScript: 全体像

- TypeScript は `TSC(TypeScript Compiler)` による型チェックによって、JavaScript に型を導入し安全性を高めている。
- コンパイラ
  - 一般的なコンパイラ: ソースコード -> AST -> バイトコード -> ランタイムによって実行される
  - TypeScriptコンパイラ: ソースコード -> AST -> TSC による型チェック -> JavaScript
- `型チェッカー(typechecker): コードが型安全であることを検証する特別なプログラム`
- `型システム(type system): プログラマーが作成したプログラムに型を割り当てるために型チェッカーが使用するルールの集まり`
- TypeScript では明示的に型を定義しなくてよい時には型推論に任せるのがよい
- 全ての型が分かっていなくてもコンパイルできる（漸進的型付き言語）が、意図しない JavaScript 実行結果を避けるため全ての型が分かっている状態を目指すべき
- 作成したプロジェクトには `tsconfig.json` を置いて、コンパイルやリントに関する設定を書く

### 3章 型について

- `型（type）: 値とそれを使ってできる事柄の集まり`
- 型の初歩
  - any: 全ての操作が可能になってしまうので避けるべき。型チェックの恩恵をとても受けづらくなってしまう
  - unknown: 型の絞り込み(typeof などで型を調べたり、否定したり)を行うまでは unknown 値は使用できない。
  - boolean, number, bigint, string: 通常は型推論させる。const で定義すると特定の値であること（true or false などリテラル型）まで推論してくれる
  - symbol: 通常は型推論させる。unique symbol という symbol から更に絞り込んだ型にもできる
  - オブジェクト
    - `構造的型付け` を採用している。ダックタイピング。振る舞いさえ持っていれば、クラスでもオブジェクトでもなんでもよい。
    - プロパティの型付けはいくつかの定義方法がある
      - key: type といった定義はオブジェクトが key という名前のプロパティを持ち、そこに type の値が入っていることを期待する。
      - key?: type といった定義は key がオプショナルになる
      - [key: T]: U といった定義は `インデックスシグネチャ` と呼ばれ、オブジェクトの型Tの全てのキーは型Uの値を持つことを期待する。同一の型のキーを安全に追加できる
      - readonly にすることで上書きできなくする
  - 型エイリアス: `type` キーワードを使って型を宣言することができる
  - 型の合併(和)と交差（積）: それぞれ `|`・`&` で表現される
  - 配列: 配列初期化時に値を持っていればその値の型と推論する。空配列を宣言したら any[] と推論し、後の配列への操作で型を絞っていく
    - タプル: 配列のサブタイプでで固定長の配列を受け付ける。
    - 読み取り専用の専用の型を宣言するための構文もある ReadonlyArrray
  - null: 値の欠如
  - undefined: 値がまだ割り当てられていない変数
  - void: return 文を持たない関数の戻り値
  - never: 決して戻ることのない関数の戻り値（e.g. エラーの throw など）
  - 列挙型: 落とし穴が多いので使わない方がいいかも

### 4章 関数

- オプションパラメーター、デフォルトパラメーター、レストパラメーター、this の型付け
- ジェネレーター: 要求に応じて次の値を計算する方法。`Generator<T>` で宣言できる。
- イテレーター: 一連の値を利用するための方法
  - `反復可能オブジェクト（Iterable）`: Symbol.iterator をプロパティに持つオブジェクトで、このプロパティはイテレーターを返す
  - `Iterator（Iterator）`: next をメソッドに持つオブジェクト。next() は value および done というプロパティを持つオブジェクト
- 関数の呼び出しシグネチャは`型レベル`のコードだけを含む。
  - e.g. type Greet = (name: string) => string
